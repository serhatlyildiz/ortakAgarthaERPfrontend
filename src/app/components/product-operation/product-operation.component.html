<div class="d-flex mb-3">
  <!-- FILTER butonu -->
  <button
    class="btn btn-primary"
    type="button"
    data-bs-toggle="collapse"
    data-bs-target="#filterMenu"
    aria-expanded="false"
    aria-controls="filterMenu"
  >
    FILTER
  </button>

  <!-- RESET FILTERS butonu -->
  <button 
    class="btn btn-danger ms-2" 
    (click)="resetFilters()" 
    *ngIf="isFilterMenuOpen">
    Reset Filters
  </button>
</div>

<div class="collapse" id="filterMenu" (shown.bs.collapse)="onFilterMenuOpen()" (hidden.bs.collapse)="onFilterMenuClose()">
  <div class="card card-body">
    <form (ngSubmit)="applyFilter()">
      <div class="row">
        <!-- Product Name (Text Input) -->
        <div class="col-md-3">
          <label for="filterProductName" style="font-weight: bold; text-decoration: underline;">Product Name</label>
          <input
            type="text"
            class="form-control"
            id="filterProductName"
            [(ngModel)]="filters.productName"
            name="productName"
          />
        </div>

        <!-- Price Range (Number Inputs) -->
        <div class="col-md-3">
          <label for="filterPriceMin" style="font-weight: bold; text-decoration: underline;">Price Range</label>
          <div class="d-flex">
            <input
              type="number"
              class="form-control"
              id="filterPriceMin"
              [(ngModel)]="filters.priceMin"
              name="priceMin"
              placeholder="Min"
            />
            <input
              type="number"
              class="form-control ms-2"
              id="filterPriceMax"
              [(ngModel)]="filters.priceMax"
              name="priceMax"
              placeholder="Max"
            />
          </div>
        </div>

        <!-- Stock Range (Number Inputs) -->
        <div class="col-md-3">
          <label for="filterStockMin" style="font-weight: bold; text-decoration: underline;">Stock Range</label>
          <div class="d-flex">
            <input
              type="number"
              class="form-control"
              id="filterStockMin"
              [(ngModel)]="filters.stockMin"
              name="stockMin"
              placeholder="Min"
            />
            <input
              type="number"
              class="form-control ms-2"
              id="filterStockMax"
              [(ngModel)]="filters.stockMax"
              name="stockMax"
              placeholder="Max"
            />
          </div>
        </div>

        <!-- Size (Combobox) -->
<div class="col-md-3">
  <label for="filterSize" style="font-weight: bold; text-decoration: underline;">Size</label>
  <select
    class="form-select"
    id="filterSize"
    [(ngModel)]="filters.size"
    name="size"
  >
    <option [value]="null">Select Size</option> <!-- VarsayÄ±lan boÅŸ seÃ§enek -->
    <option *ngFor="let size of sizes" [value]="size.id">{{ size.name }}</option>
  </select>
</div>

        <!-- Color (Combobox) -->
<div class="col-md-3">
  <label for="filterColor" style="font-weight: bold; text-decoration: underline;">Color</label>
  <select
    class="form-select"
    id="filterColor"
    [(ngModel)]="filters.color"
    name="color"
  >
    <option [value]="null">Select Color</option>
    <option *ngFor="let color of colors" [value]="color.colorName">{{ color.colorName }}</option>
  </select>
</div>

 <!-- Super Category (Combobox) -->
<div class="col-md-3">
  <label for="filterSuperCategory" style="font-weight: bold; text-decoration: underline;">Super Category</label>
  <select
    class="form-select"
    id="filterSuperCategory"
    [(ngModel)]="filters.superCategory"
    (change)="onSuperCategoryChange(filters.superCategory)"
    name="superCategory"
  >
    <option [value]="null">Select Super Category</option>
    <option *ngFor="let superCategory of superCategories" [value]="superCategory.superCategoryId">
      {{ superCategory.superCategoryName }}
    </option>
  </select>
</div>

<!-- Category (Combobox) -->
<div class="col-md-3">
  <label for="filterCategory" style="font-weight: bold; text-decoration: underline;">Category</label>
  <select
    class="form-select"
    id="filterCategory"
    [(ngModel)]="filters.category"
    name="category"
   
  >
    <option [value]="null">Select Category</option>
    <option *ngFor="let category of categories" [value]="category.categoryName">
      {{ category.categoryName }}
    </option>
  </select>
</div>


        <!-- Status (Radio Buttons) -->
        <div class="col-md-3">
          <label style="font-weight: bold; text-decoration: underline;">Status</label>
          <div class="d-flex align-items-center">
            <div class="form-check me-3">
              <input 
                type="radio" 
                class="form-check-input" 
                id="statusAll" 
                name="status"
                [(ngModel)]="filters.status" 
                [value]="null"
              />
              <label class="form-check-label" for="statusAll">All</label>
            </div>
            
            <div class="form-check me-3">
              <input 
                type="radio" 
                class="form-check-input" 
                id="statusActive" 
                name="status"
                [(ngModel)]="filters.status" 
                [value]="true"
              />
              <label class="form-check-label" for="statusActive">Active</label>
            </div>
            
            <div class="form-check">
              <input 
                type="radio" 
                class="form-check-input" 
                id="statusInactive" 
                name="status"
                [(ngModel)]="filters.status" 
                [value]="false"
              />
              <label class="form-check-label" for="statusInactive">Inactive</label>
            </div>
          </div>
        </div>

        <!-- Submit Button -->
        <div class="col-md-3 d-flex align-items-end">
          <button class="btn btn-success w-100" type="submit">Apply Filters</button>
        </div>
      </div>
    </form>
  </div>
</div>
<div *ngIf="!isLoading && !errorMessage" style="overflow-x: auto;">
  <table class="table table-hover">
    <thead class="table-hover">
      <tr>
        <th (click)="sort('productName')">
          ÃœrÃ¼n AdÄ±
          <span *ngIf="sortColumn === 'productName'">
            {{ sortOrder === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
          </span>
        </th>
        <th (click)="sort('productDescription')">
          AÃ§Ä±klama
          <span *ngIf="sortColumn === 'productDescription'">
            {{ sortOrder === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
          </span>
        </th>
        <th (click)="sort('unitPrice')">
          Fiyat
          <span *ngIf="sortColumn === 'unitPrice'">
            {{ sortOrder === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
          </span>
        </th>
        <th (click)="sort('unitsInStock')">
          Stok MiktarÄ±
          <span *ngIf="sortColumn === 'unitsInStock'">
            {{ sortOrder === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
          </span>
        </th>
        <th (click)="sort('productSize')">
          Boyut
          <span *ngIf="sortColumn === 'productSize'">
            {{ sortOrder === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
          </span>
        </th>
        <th (click)="sort('colorName')">
          Renk
          <span *ngIf="sortColumn === 'colorName'">
            {{ sortOrder === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
          </span>
        </th>
        <th (click)="sort('categoryName')">
          Kategori
          <span *ngIf="sortColumn === 'categoryName'">
            {{ sortOrder === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
          </span>
        </th>
        <th (click)="sort('superCategoryName')">
          SÃ¼per Kategori
          <span *ngIf="sortColumn === 'superCategoryName'">
            {{ sortOrder === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
          </span>
        </th>
        <th>Resimler</th>
        <th (click)="sort('status')">
          Status
          <span *ngIf="sortColumn === 'status'">
            {{ sortOrder === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
          </span>
        </th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let product of productDetails" class="product-row" (mouseenter)="showButton = true" (mouseleave)="showButton = false">
        <td>{{ product.productName }}</td>
        <td>{{ product.productDescription }}</td>
        <td>{{ product.unitPrice | currency: 'â‚º ' }}</td>
        <td>{{ product.unitsInStock }}</td>
        <td>{{ product.productSize }}</td>
        <td>{{ product.colorName }}</td>
        <td>{{ product.categoryName }}</td>
        <td>{{ product.superCategoryName }}</td>
        <td>
          <div class="image-container">
            <img [src]="product.images[currentImageIndex[product.productId]]" alt="{{ product.productName }}" class="table-image" />
            <button *ngIf="showButton" class="next-button" (click)="nextImage(product.productId)">&#8594;</button>
          </div>       
        </td>
        <td>{{ product.status }}</td>
        <td>
          <div class="button-group">
            <button
              class="compact-btn btn-update"
              (click)="updateProduct(product.id)"
              [disabled]="product.status === false"
            >
              GÃ¼ncelle
            </button>
            <button
              class="compact-btn"
              [ngClass]="{
                'btn-danger': product.status,
                'btn-success': !product.status
              }"
              (click)="toggleStatus(product)"
            >
              {{ product.status ? 'Sil' : 'Aktif Et' }}
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
